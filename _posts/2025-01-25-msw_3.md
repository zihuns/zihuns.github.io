---
title: "MSW í™œìš©ê¸° | (3) Plugin ë°©ì‹ìœ¼ë¡œ ì œê³µí•˜ê¸°"
contribution: 100
date: 2024-06-22 01:00:00 +0900
lastmod: 2025-09-21 14:30:00 +0900
start_date: 2024-04-29
end_date: 2024-06-18
categories: [Frontend, MSW]
tags: [msw, vue, plugin]
series: "MSW í™œìš©ê¸°"
order: 3
excerpt: "MSWë¥¼ í”„ë¡œì íŠ¸ì—ì„œ í¸ë¦¬í•˜ê²Œ í™œìš©í•˜ê¸° ìœ„í•´ Plugin í˜•íƒœë¡œ ì œê³µí•˜ëŠ” ë°©ë²•ì„ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤."
---

> ğŸ“Œ ì´ ê¸€ì€ **MSW ì‹œë¦¬ì¦ˆ** ì¤‘ 3í¸ì…ë‹ˆë‹¤.  
> 1í¸: [MSWë€?](/posts/msw_1)  
> 2í¸: [Mock API Schema ìë™ ìƒì„±í•˜ê¸°](/posts/msw_2)

---

## ë¶€ì œ: MSWë¥¼ ì–´ë–»ê²Œ í•´ì•¼ í¸í•˜ê²Œ ì“¸ ìˆ˜ ìˆì„ê¹Œ

MSW ê¸°ëŠ¥ì„ êµ¬í˜„í–ˆë‹¤ê³  í•´ë„, **ì‹¤ì§ˆì ìœ¼ë¡œ ì“°ê¸° í¸í•´ì•¼** íŒ€ì›ë“¤ì´ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ê·¸ë˜ì„œ ì´ë²ˆ ê¸€ì—ì„œëŠ” í˜„ì¬ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš© ì¤‘ì¸ `modulesPlugin` íŒ¨í„´ì„ ì°¸ê³ í•´, **Vue Plugin ë°©ì‹ìœ¼ë¡œ MSWë¥¼ ì œê³µ**í•˜ëŠ” ë°©ë²•ì„ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.

ì¦‰, `main.js`ì— `mswPlugin`ì„ ì„¤ì¹˜í•˜ê³ , í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” í•„ìš”í•œ í•¨ìˆ˜ë¥¼ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±í•©ë‹ˆë‹¤.

---

## ê¸°ëŠ¥ êµ¬í˜„

ì•„ë˜ëŠ” `mswWorkerPlugin.js`ì˜ í•µì‹¬ ì½”ë“œì…ë‹ˆë‹¤.

```js
const worker = setupWorker();

// MSW ì‹œì‘
const setupMSW = () => {
  if (typeof window !== "undefined") {
    worker.start({ onUnhandledRequest: "bypass" });
  }
};

// JSON Schemaë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°€ì§œ ë°ì´í„°ë¥¼ ìƒì„±
export const generateFakeData = schema => {
  const fakeData = jsf.generate(schema);
  return fakeData;
};

// íŒŒì¼ ì—¬ë¶€ í™•ì¸ í›„ ê°€ì§œ ë°ì´í„° ë°˜í™˜
const setMockData = async (apiPath, method = "get") => {
  let schema;
  const filePath = apiPath.replace(/\//gi, "_");
  await import(`@/mocks/apiSchema/*/${filePath}.json`)
    .then(res => {
      schema = res.default;
    })
    .catch(() => {
      console.warn(`íŒŒì¼ ì—†ìŒ ë˜ëŠ” ì˜¤ë¥˜ ë°œìƒ: ${apiPath}`);
    });

  if (!schema) {
    schema = await getSchema(apiPath, method);
  }

  return () => {
    return HttpResponse.json({ ...generateFakeData(schema), returnCode: "200" });
  };
};

// Vue Plugin ì •ì˜
const mswPlugin = {
  install(Vue) {
    setupMSW(); // install ì‹œ MSW Enable
    Vue.prototype.$mswPlugin = {
      async setupHandler(apiPath, method, resolver) {
        worker.use(...(await this.setHandlers(apiPath, method, resolver)));
      },
      resetHandler(handlers = []) {
        worker.resetHandlers(...handlers);
      },
      stopMSW() {
        worker.stop();
      },
      async setHandlers(apiPath, method = "get", resolver) {
        const handlers = [];
        try {
          const path = apiPath.match(/\/display(\/[^?#]*)/);
          apiPath = path ? path[1] : apiPath;
          const handler = http.get(
            `*${apiPath}`,
            resolver ? resolver : await setMockData(apiPath, method.toLowerCase())
          );
          handlers.push(handler);
        } catch (error) {
          console.error(`Handler ìƒì„± ì‹¤íŒ¨: ${apiPath}`, error);
        }
        return handlers;
      }
    };
  }
};

export default mswPlugin;
```
{: file="mswWorkerPlugin.js" }

## ì‚¬ìš©ë²• ë° ì˜ˆì‹œ

### 1. Plugin ë“±ë¡

```js
// main.js
import mswPlugin from "@/mocks/mswWorkerPlugin.js";
Vue.use(mswPlugin.install);
```
{: file="main.js" }

### 2. ê¸°ë³¸ ì‚¬ìš© ì˜ˆì‹œ

```js
import handlers from "@/mocks/handlers/sample.handler.js";

async created() {
  await this.$mswPlugin.setupHandler(this.data.asyncUrl);
  await this.$mswPlugin.setupHandler("/api/data", "GET", await handlers.test(apiUrl));
  await this.$mswPlugin.setupHandler("/api/data2", null, handlers.setData);
}
```
{: file="Component.vue" }

### 3. ì»¤ìŠ¤í…€ Handler ì‘ì„±

```js
import { HttpResponse } from "msw";
import { getSchema } from "@/mocks/getApiSchema.js";
import { generateFakeData } from "@/mocks/mswWorkerPlugin.js";

const handlers = {
  setData: () => {
    return HttpResponse.json({ data: { name: "hi", returnCode: "200" } });
  },
  async test(path) {
    const schema = await getSchema(path);
    let mockData = generateFakeData(schema);

    // List ê¸¸ì´ê°€ 3 ì´ˆê³¼ ì‹œ ì˜ë¼ë‚´ëŠ” ì˜ˆì‹œ ë¡œì§
    if (mockData.data.tabList.length > 3) {
      mockData.data.tabList = mockData.data.tabList.slice(0, 1);
    }

    return () => {
      return HttpResponse.json({ ...mockData, returnCode: "200" });
    };
  }
};

export default handlers;
```
{: file="handlers/sample.handler.js" }

## ê²°ê³¼ë¬¼

ì•„ë˜ëŠ” ì‹¤ì œ ì ìš© í›„ ìº¡ì²˜ í™”ë©´ì…ë‹ˆë‹¤.

![MSW Plugin ì ìš© í›„ ë„¤íŠ¸ì›Œí¬ íƒ­](/assets/img/2025-01-25/2025-01-25-msw_3_1.png)
_MSW Plugin ì ìš© í›„ ë„¤íŠ¸ì›Œí¬ íƒ­_

![MSW Pluginìœ¼ë¡œ Mockingëœ ë°ì´í„°](/assets/img/2025-01-25/2025-01-25-msw_3_2.png)
_MSW Pluginìœ¼ë¡œ Mockingëœ ë°ì´í„°_

## ì •ë¦¬

- `mswPlugin`ìœ¼ë¡œ MSWë¥¼ Vue Plugin ë°©ì‹ìœ¼ë¡œ ì œê³µí•©ë‹ˆë‹¤.
- íŒ€ì›ë“¤ì´ ë³µì¡í•œ ì„¤ì • ì—†ì´, `this.$mswPlugin.setupHandler()` í˜•íƒœë¡œ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì»¤ìŠ¤í…€ í•¸ë“¤ëŸ¬ ì‘ì„±ì´ ê°€ëŠ¥í•´ í™•ì¥ì„±ì„ í™•ë³´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
